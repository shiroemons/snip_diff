# SnipDiff UI/UX 仕様書

## 画面構成

SnipDiffのメインウィンドウは以下の4つのセクションで構成されています：

```
┌─────────────────────────────────────────────────────┐
│ Header (ヘッダー)                                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│ Input Editor Panel (入力エディタパネル)              │
│  ┌─────────────────┬─────────────────┐             │
│  │  Before (左)     │  After (右)      │             │
│  │                 │                 │             │
│  └─────────────────┴─────────────────┘             │
│                                                     │
├═════════════════════════════════════════════════════┤ ← Resize Handle
│ Comparison Panel (差分表示パネル)                    │
│  Monaco Diff Editor                                │
│                                                     │
├─────────────────────────────────────────────────────┤
│ Footer (フッター)                                    │
└─────────────────────────────────────────────────────┘
```

## 1. Header (ヘッダー)

### 1.1 左側セクション
- **アプリタイトル**: "SnipDiff"
- **バージョン表示**: `v{version}`（例: v2025.10.0）
- **テーマ切り替えボタン**:
  - 太陽アイコン（ライト）/月アイコン（ダーク）
  - クリックでドロップダウンメニュー表示
  - 3つのオプション: ライトテーマ、ダークテーマ、システムテーマ

### 1.2 右側セクション（コントロール）

#### オプショングループ
- **空白無視**: トグルボタン、アクティブ時にハイライト
- **折り返し**: テキストの折り返し表示をオン/オフ

#### アクショングループ
- **↔ 入替**: 左右のテキストを入れ替え（`⌘⇧K`）
- **クリア**: 両方のエディタをクリア（`⌘K`）

### 1.3 ウィンドウコントロール（macOS標準）
- 最大化時は `maximized` クラスが適用され、スタイルが調整される

## 2. Input Editor Panel (入力エディタパネル)

### 2.1 レイアウト
- 左右に2つのMonaco Editorを配置
- 各エディタの上部にコントロールバー

### 2.2 左エディタ（Before）

#### コントロールバー
- **ラベル**: "Before"
- **貼り付けボタン**: クリップボードからテキストを貼り付け
  - アイコン: Clipboard
  - ツールチップ: "クリップボードから貼り付け"
- **クリアボタン**: エディタの内容をクリア
  - アイコン: X
  - ツールチップ: "クリア"

#### エディタ機能
- リアルタイムシンタックスハイライト
- 行番号表示
- ミニマップ
- スクロールバー
- フォールディング（コード折りたたみ）
- オートコンプリート

### 2.3 右エディタ（After）
- 左エディタと同じ構成・機能

### 2.4 リサイズ機能
- パネル全体の高さは可変
- リサイズハンドルをドラッグして調整
- 最小化時は差分パネルが非表示になり、入力エディタが全画面表示

## 3. Comparison Panel (差分表示パネル)

### 3.1 パネルヘッダー

#### 左側
- **タイトル**: "差分表示"

#### 中央
- **ビューモード切り替え**:
  - `Unified` ボタン: 統合表示（`⌘1`）
  - `Side by Side` ボタン: 左右並列表示（`⌘2`）
  - アクティブなモードはハイライト表示

- **Compactモードチェックボックス**:
  - ラベル: "Compact"
  - ツールチップ: "Compact Mode (⌘3)"
  - チェックでCompactモード有効化

#### 右側（アクションボタン）
- **最小化/復元ボタン**:
  - アイコン: ChevronDown（最小化）/ ChevronUp（復元）
  - ツールチップ: "パネルを最小化" / "パネルを復元"
- **全画面/復元ボタン**:
  - アイコン: Maximize2（全画面化）/ Minimize2（復元）
  - ツールチップ: "全画面表示" / "元のサイズに戻す"

### 3.2 リサイズハンドル
- パネルヘッダーの上部に配置
- 水平方向のバー表示
- ドラッグで高さ調整
- リサイズ中は `resizing` クラスでスタイル変更
- ARIAラベル: "比較パネルのリサイズハンドル"

### 3.3 差分エディタ（Monaco Diff Editor）

#### Side-by-Side モード
```
┌──────────────────┬──────────────────┐
│  Original        │  Modified        │
│  (削除を赤背景)   │  (追加を緑背景)   │
│                  │                  │
│  - 削除行         │  + 追加行         │
│    共通行         │    共通行         │
└──────────────────┴──────────────────┘
```

#### Unified モード
```
┌─────────────────────────────────────┐
│  @@ -1,3 +1,3 @@                    │
│  - 削除行 (赤背景)                   │
│  + 追加行 (緑背景)                   │
│    共通行                            │
└─────────────────────────────────────┘
```

#### Compactモード（オン時）
- 行全体の背景色を削除
- 実際に変更された文字のみハイライト
- 削除: 赤い下線 + 赤背景
- 追加: 緑の下線 + 緑背景
- 変更されていない領域を自動折りたたみ
- インジケータとOverview Rulerを非表示

### 3.4 パネルの状態

#### 通常表示
- デフォルトの高さ: 350px
- リサイズ可能範囲: 100px〜800px

#### 最小化状態
- 高さ: 40px（ヘッダーのみ表示）
- 差分エディタは非表示
- 入力エディタが拡大

#### 全画面表示
- 高さ: 100%（画面全体）
- 入力エディタは非表示
- リサイズハンドルも非表示

#### ウィンドウ最大化時
- `maximized` クラスが適用され、スタイル調整

## 4. Footer (フッター)

### 4.1 左側セクション（統計情報）
- **追加行数**: `+N`（緑色）
- **削除行数**: `-N`（赤色）
- **Hunks数**: `N hunks`
- 統計がない場合は非表示

### 4.2 右側セクション（エディタ設定）

#### フォントサイズ
- ラベル: "フォントサイズ:"
- セレクトボックス: 10〜36px（2px刻み）
- デフォルト: 14px

#### インデント設定
- **インデント方式**: スペース / タブ
- **インデントサイズ**: 2 / 4 / 8
- セパレータ `|` で区切り

#### 改行コード設定
- ラベル: "改行コード:"
- **Before用セレクト**: Auto / LF / CRLF
- **After用セレクト**: Auto / LF / CRLF

#### 言語モード
- セレクトボックス（幅広）
- 23言語をサポート
- デフォルト: Plain Text

#### 開発者モード表示（開発環境のみ）
- バッジ: "DEV"
- ツールチップ: "開発者モード有効"

#### 設定ボタン
- アイコン: Settings（歯車）
- ツールチップ: "設定を開く"
- クリックで設定モーダルを表示

## 5. Settings Modal (設定モーダル)

### 5.1 モーダル構成
- オーバーレイ: 半透明の黒背景
- モーダル本体: 中央配置の白/黒パネル
- 外側クリックまたはESCキーで閉じる

### 5.2 ヘッダー
- **タイトル**: "設定"
- **閉じるボタン**: `×` ボタン

### 5.3 設定セクション

#### 開発者向け設定（開発環境のみ）
- セクションタイトル: "開発者向け設定"
- 説明: "開発環境でのみ利用可能な設定です。"
- **開発者モード**: チェックボックス

#### アプリケーション設定
- セクションタイトル: "アプリケーション"
- 説明: "アプリケーション全体に関する設定です。"

##### 自動更新チェック
- チェックボックス: "自動更新チェック"
- 説明: "アプリ起動時に自動的に更新をチェックします。新しいバージョンが見つかった場合は通知が表示されます。"
- **今すぐ更新を確認ボタン**:
  - 更新チェック実行中: "確認中..."（無効化）
  - 更新利用可能時: "新しいバージョンが利用可能です"（無効化）
  - 通常時: "今すぐ更新を確認"
- 更新チェック結果メッセージ表示
- 最終確認日時表示: "最終確認: YYYY/MM/DD HH:MM"

#### デフォルト値の設定
- セクションタイトル: "デフォルト値の設定"
- 説明: "アプリケーション起動時や新しく比較を開始する際のデフォルト値を設定します。"

##### テーマ
- セレクトボックス: ライトテーマ / ダークテーマ / システムテーマ
- 説明: "エディターの外観を変更します。「システムテーマ」を選択すると、macOSの設定に従います。"

##### フォントサイズ
- セレクトボックス: 10〜36px
- 説明: "エディターで表示されるテキストのサイズを変更します。"

##### 比較の方式
- セレクトボックス: Side by Side / Unified
- 説明: "Side by Side（左右並べて表示）またはUnified（統合表示）を選択できます。"

##### Compactモード
- チェックボックス: "Compactモード"
- 説明: "行レベルの背景色を削除し、実際に変更された文字だけを精密にハイライト表示します。"

##### インデント方式
- セレクトボックス: スペース / タブ
- 説明: "Tabキーを押したときにスペースまたはタブ文字のどちらを挿入するかを設定します。"

##### インデントサイズ
- セレクトボックス: 2 / 4 / 8
- 説明: "インデント1つあたりのスペース数、またはタブ文字の表示幅を設定します。"

##### デフォルト改行コード
- セレクトボックス: Auto / LF / CRLF
- 説明: "新規入力時の改行コードを設定します（LF: Unix/Mac、CRLF: Windows、Auto: OSに従う）。"

##### デフォルト言語モード
- セレクトボックス: 23言語から選択
- 説明: "シンタックスハイライトに使用する言語を設定します。コードの構文に応じた色分けが適用されます。"

### 5.4 フッター

#### 左側
- **デフォルトにリセットボタン**:
  - ラベル: "デフォルトにリセット"
  - ツールチップ: "すべての設定をデフォルト値にリセットします"
  - クリックで確認ダイアログ表示

#### 右側
- **キャンセルボタン**: 変更を破棄してモーダルを閉じる
- **保存ボタン**: 設定を保存してモーダルを閉じる

## 6. Update Notification (更新通知)

### 6.1 通知バナー
- 画面上部に表示される通知バナー
- ライト/ダークテーマに対応したスタイル

### 6.2 表示内容
- **タイトル**: "新しいバージョンが利用可能です"
- **バージョン情報**: `バージョン {version} がリリースされました`

### 6.3 ボタン
- **ダウンロードボタン**: クリックでダウンロード開始
- **閉じるボタン**: `×` ボタンで通知を閉じる

### 6.4 ダウンロード中
- **プログレスバー**: ダウンロード進捗を表示
- **パーセンテージ**: `{percent}%`
- **キャンセルボタン**: ダウンロードを中止

### 6.5 ダウンロード完了
- **メッセージ**: "ダウンロードが完了しました"
- **インストールボタン**: クリックでアプリ再起動とインストール実行
- **後でボタン**: 通知を閉じる

## 7. キーボードショートカット

### 7.1 グローバルショートカット
| ショートカット | 機能 |
|--------------|------|
| `⌘K` | クリア |
| `⌘⇧K` | 左右入れ替え |
| `⌘1` | Unifiedモード |
| `⌘2` | Side-by-Sideモード |
| `⌘3` | Compactモードトグル |

### 7.2 モーダル
| ショートカット | 機能 |
|--------------|------|
| `ESC` | モーダルを閉じる |

### 7.3 メニュー（macOS標準）
- アプリケーションメニュー、編集、表示、ウィンドウなど

## 8. 色とスタイル

### 8.1 差分ハイライト（通常モード）

#### ライトテーマ
- **追加行**: 淡い緑背景（`#e6ffed`）
- **削除行**: 淡い赤背景（`#ffeef0`）
- **追加文字**: 濃い緑背景（`#acf2bd`）
- **削除文字**: 濃い赤背景（`#fdb8c0`）

#### ダークテーマ
- **追加行**: 暗い緑背景（`#044B1F`）
- **削除行**: 暗い赤背景（`#5A1C1C`）
- **追加文字**: 緑背景（`#0E6027`）
- **削除文字**: 赤背景（`#8B2A2A`）

### 8.2 Compactモードハイライト

#### ライトテーマ
- **削除**: 赤下線（`#d73a49`）+ 赤背景（`rgba(255,200,200,0.3)`）
- **追加**: 緑下線（`#22863a`）+ 緑背景（`rgba(200,255,200,0.3)`）

#### ダークテーマ
- **削除**: 赤下線（`#f97583`）+ 赤背景（`rgba(255,100,100,0.2)`）
- **追加**: 緑下線（`#85e89d`）+ 緑背景（`rgba(100,255,100,0.2)`）

### 8.3 フォント
- **等幅フォント**: Monaco Editorのデフォルト（SF Mono / Menlo優先）
- **フォントサイズ**: 10〜36px（設定可能）

## 9. アクセシビリティ

### 9.1 ARIA属性
- すべてのインタラクティブ要素に適切なARIAラベル
- モーダルに `role="dialog"` と `aria-modal="true"`
- リサイズハンドルに `role="separator"`

### 9.2 キーボード操作
- タブキーでフォーカス移動
- Enterキーでボタン実行
- ESCキーでモーダル閉じる

### 9.3 フォーカス管理
- フォーカス時の視覚的インジケータ
- モーダルオープン時のフォーカストラップ
